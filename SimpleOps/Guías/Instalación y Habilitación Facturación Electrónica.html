<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="CSS/Estilos.css">
</head>

<body>

    <style>
        /* Temporalmente se copia textual desde Estilos.css para poder que funcione con htmlpreview.github.io. */

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            width: 800px;
            margin: auto;
        }

        img {
            display: block;
            margin: auto;
            margin-top: 80px;
            margin-bottom: 80px;
            max-width: 800px;
        }

        h1, h2 {
            margin-top: 80px;
            margin-bottom: 30px;
        }

        h3 {
            margin-top: 40px;
        }

        li {
            margin-bottom: 10px;
            margin-top: 10px;
        }

        .código {
            font-family: Courier New, Courier, monospace;
            margin-bottom: 50px;
            margin-top: 50px;
        }

    </style>

    <h1>Instalación de SimpleOps y Habilitación de la Facturación Electrónica</h1>

    <p>
        Para que <b>SimpleOps</b> pueda generar tus facturas electrónicas válidas legalmente es necesario que habilites a tu
        empresa ante la DIAN cómo facturador electrónico usando <b>SimpleOps</b>, que compres y generes un certificado de firma digital con una entidad
        certificadora y que realices las pruebas de facturación electrónica con <b>SimpleOps</b> en el servidor de la DIAN.
    </p>

    <p>
        Esta guía fue escrita para empresas (personas jurídicas). Si necesitas facturar electrónicamente como persona natural, aún puedes seguir
        esta guía, pero ten en cuenta que tendrás que realizar algunos pasos de manera diferente. La facturación electrónica solo está implementada
        para la DIAN de Colombia. Si estás en otro país, puedes usar <b>SimpleOps</b> como ERP pero deberás desactivar la funcionalidad de facturación
        electrónica.
    </p>

    <h2>Pasos</h2>

    <ul style="list-style-type: decimal;">
        <li><a href="#paso1">Habilitación de Pruebas en la DIAN</a></li>
        <li><a href="#paso2">Obtención de Certificado de Firma Digital</a></li>
        <li><a href="#paso3">Instalación de SimpleOps</a></li>
        <li><a href="#paso4">Configuración de SimpleOps en tu Computador</a></li>
        <li><a href="#paso5">Configuración de los Datos de tu Empresa en SimpleOps</a></li>
        <li><a href="#paso6">Pruebas Internas de Facturación y Personalización de Factura</a></li>
        <li><a href="#paso7">Pruebas de Habilitación en la DIAN</a></li>
        <li><a href="#paso8">Solicitud de la Resolución de Facturación Electrónica a la DIAN</a></li>
        <li><a href="#paso9">Configuración de Modo Producción</a></li>
        <li><a href="#paso10">Facturación Electrónica</a></li>
        <li><a href="#paso11">Facturación Electrónica usando Excel (Opcional)</a></li>
    </ul>

    <h2 id="paso1">1. Habilitación de Pruebas en la DIAN</h2>

    <p>
        Ingresa a <a href="https://www.dian.gov.co">www.dian.gov.co</a> y haz clic en <i>Temas de interés > Factura Electrónica > Habilitación</i>.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/DianHabilitación.png" />

    <p>
        Selecciona <i>Empresa</i>.
        Si el representante legal de tu empresa es una persona natural colombiana, deja la opción <i>Cédula de ciudadanía</i> seleccionada.
        Ingresa el número de la cédula del representante legal, el NIT de tu empresa sin número de verificación y has clic en <i>Entrar</i>.
        Si te aparece el error <i>Recaptcha inválido</i>, ingresa nuevamente desde <a href="https://www.dian.gov.co">www.dian.gov.co</a>
        y hazlo más rápidamente.
    </p>

    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/EntrarDianPortal.png" />

    <p>Obtendrás un mensaje así:</p>

    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/MensajeEnlaceAccesoDIAN.png" />

    <p>
        Revisa tu cuenta de email que registraste en la DIAN cuando actualizaste tu RUT, abre el mensaje que te debió haber llegado de la DIAN
        y haz clic en <i>Acceder</i>.
    </p>

    <p>
        Se abrirá el portal de habilitación.
        Haz clic en <i>Participantes > Facturador</i>. Revisa los datos de tu empresa, agrega el correo electrónico donde recibirás las facturas
        electrónicas de tus proveedores y haz clic en <i>Registrar</i>.
    </p>

    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/RegistroFacturadorElectrónico.png" />

    <p>
        Te preguntará si estás seguro de proceder, dale clic en <i>Sí</i> e inicia otra vez sesión como se describió anteriormente.
        Haz clic en <i>Participantes > Facturador</i> y haz clic en <i>Configurar modos de operación</i>.
    </p>

    <p>
        Selecciona la opción <i>Software Propio</i>. En <i>Nombre del software</i> escribe SimpleOps######### donde ######### es el Nit de tu empresa.
        Por ejemplo, SimpleOps990823244. En <i>Pin del SW</i> escribe una contraseña propia de 5 números, guárdala en un lugar seguro con el nombre
        <i>PinAplicación</i>. Finalmente, haz clic en <i>Adicionar</i>.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/AdiciónModoOperación.png" />

    <p>
        Se agregará una nueva fila a la tabla inferior.
        Haz clic en el ícono derecho en la columna <i>Acciones</i>. Ten cuidado de no hacer clic en la papelera que está a la izquierda de este.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/DetallesSetDePruebas.png" />

    <p>
        Te aparecerá una página donde debes copiar y guardar en un lugar seguro estos valores que necesitarás para configurar <b>SimpleOps</b>
        e iniciar las pruebas de facturación:

        <ul>
            <li><i>TestSetID</i>, guárdalo con el nombre <i>IdentificadorPruebas</i>.</li>
            <li><i>Número Resolución</i>, guárdalo con el nombre <i>NúmeroAutorizaciónFacturación</i>.</li>
            <li><i>Rango desde</i>, guárdalo con el nombre <i>PrimerNúmeroFacturaAutorizada</i>.</li>
            <li><i>Rango hasta</i>, guárdalo con el nombre <i>ÚltimoNúmeroFacturaAutorizada</i>.</li>
            <li><i>Fecha desde</i>, guárdala con el nombre <i>InicioAutorizaciónFacturación</i>.</li>
            <li><i>Fecha hasta</i>, guárdala con el nombre <i>FinAutorizaciónFacturación</i>.</li>
            <li><i>Identificación</i>, guárdala con el nombre <i>IdentificadorAplicación</i>.</li>
            <li><i>Clave técnica</i>, guárdala con el nombre <i>ClaveTécnicaAplicación</i>.</li>
            <li><i>Pin</i>, guárdalo con el nombre <i>PinAplicación</i>. Este valor ya lo deberías tener guardado del paso anterior.</li>
        </ul>

    </p>

    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/ParametrosFacturaciónElectrónica.png" />

    <p>
        Al copiar los valores asegúrate que los estas copiando completos, pues si la pantalla de tu computador es pequeña parte de algunos textos
        se pueden esconder. Si este es tu caso, selecciona con el mouse desde el inicio del texto, desplázalo hasta el
        final del cuadro de texto hasta que no aparezcan más letras nuevas y presiona <i>Ctrl + C</i> para copiar.
    </p>

    <p>
        Al finalizar estos pasos tu empresa quedará habilitada en la DIAN para iniciar las pruebas de facturación electrónica usando <b>SimpleOps</b>.
        Para realizar estas pruebas necesitarás un certificado de firma digital.
    </p>


    <h2 id="paso2">2. Obtención de Certificado de Firma Digital</h2>
    <p>
        Un certificado digital es un archivo con extensión PFX que necesitarás para enviar las facturas electrónicas a la DIAN.
        Existen varias entidades certificadoras en Colombia que te pueden vender este archivo anualmente.
        Las puedes consultar <a href="https://onac.org.co/directorio-de-acreditacion-buscador">aquí</a>,
        selecciona <i>Entidades Certificación Digital (ECD)</i>, <i>Entidad de Certificación Abierta</i> y haz clic en <i>Buscar</i>.
    </p>

    <p>
        Si actualmente facturas electrónicamente con otra aplicación o con el portal de la DIAN, no necesitarás realizar este procedimiento
        nuevamente para poder facturar con <b>SimpleOps</b>. El certificado de firma digital que ya tienes te servirá.
        Asegúrate de tener tu archivo PFX y tu clave y pasa al procedimiento de pruebas.
    </p>


    <p>
        Si aún no facturas electrónicamente y no tienes certificado de firma digital puedes seguir
        <a href="Certificado de Firma Digital Andes.html">esta guía</a> para
        adquirirlo con Andes SCD.
        <b>SimpleOps</b> no tiene ninguna relación con Andes SCD ni recibe comisión por realizar esta recomendación.
    </p>


    <h2 id="paso3">3. Instalación de SimpleOps</h2>

    <p>
        Una vez hayas habilitado a <b>SimpleOps</b> en el portal de la DIAN y hayas obtenido el certificado de firma digital podrás configurar
        <b>SimpleOps</b> con los datos de tu empresa y realizar las pruebas en el servidor de la DIAN, que una vez pasadas te permitirán empezar
        a facturar electrónicamente.
    </p>


    <p>
        <b>SimpleOps</b> se encuentra en desarrollo, por lo tanto aún no cuenta con instalador y la mejor
        manera de ejecutarlo es directamente desde el código fuente. Para ejecutar el código necesitarás
        <a href="https://visualstudio.microsoft.com/es/vs/community/">Visual Studio</a>. Si ya tienes instalado Visual Studio, actualízalo
        a la última versión (busca y abre Visual Studio Installer en Windows). Además, recuerda que la 
        <a href="https://github.com/vixark/SimpleOps#licencia">licencia</a> de SimpleOps es 
        <a href="https://es.wikipedia.org/wiki/GNU_Affero_General_Public_License">AGPL</a>, lo que implica que el usuario <b>siempre</b> debe 
        recibir una copia del código. Instalarlo de esta manera automáticamente garantiza el cumplimiento de esta obligación.
    </p>

    <p>
        Crea una carpeta en tu computador con el nombre <i>SimpleOps</i> y crea dentro de ella la carpeta <i>Código</i>
        y la carpeta <i>Firma Electrónica</i>. Para fines de esta guía la ruta de la carpeta SimpleOps se llamará <i>[RutaSimpleOps]</i>,
        esta puede ser, por ejemplo: <i>D:\Programas\SimpleOps</i>.
        Asegúrate de crear las carpetas exactamente cómo están escritas (incluyendo tildes) para que no tengas
        contratiempos.
    </p>

    <p>
        Copia y pega (no lo cortes) tu archivo PFX con tu certificado de firma digital en <i>[RutaSimpleOps]\Firma Electrónica</i> y renómbralo a
        <i>Certificado.pfx</i>. Crea un archivo de texto (extensión .txt) en <i>[RutaSimpleOps]\Firma Electrónica</i>,
        nómbralo <i>Clave.txt</i>,
        ábrelo, escribe tu clave del certificado de firma digital sin agregar espacios ni nuevas líneas y guárdalo.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/ArchivosFirmaElectrónica.png" />

    <p>
        Abre Visual Studio y haz clic en <i>Tareas Iniciales > Clonar un repositorio</i>. En <i>Ubicación del repositorio</i>
        ingresa https://github.com/vixark/SimpleOps.git y en <i>Ruta de acceso</i> selecciona <i>[RutaSimpleOps]\Código</i>
        y haz clic en <i>Clonar</i>.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/ClonarRepositorio.png" />


    <p>
        Abre el <i>Explorador de Soluciones</i> y haz doble clic en <i>SimpleOps.sln</i>.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/AbrirSimpleOpsSln.png" />

    <p>
        Con esto abrirás el código por primera vez. La próxima vez que vayas a abrir el código abre
        el archivo <i>[RutaSimpleOps]\Código\SimpleOps.sln</i> y actualiza el código a la última versión en el repositorio haciendo clic
        en la esquina inferior derecha en <i>master > "Pull"</i>.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/ActualizarCambiosSimpleOpsSln.png" />

    <p>
        Si te sale el error <i>No se pueden incorporar los cambios...</i>, en <i>Cambios de GIT > Cambios</i>, haz <i>clic derecho > Deshacer Cambios</i>
        en los archivos que cambiaste (usualmente <i>Configuración.cs</i>) e intenta actualizar el código nuevamente.
        Ten cuidado si has realizado cambios al código adicionales a los indicados en esta guía porque te podrían aparecer más archivos en conflicto y deberás analizar con
        más cuidado cómo proceder para evitar perder tus cambios.
    </p>

    <p>
        Abre en el Explorador de Soluciones <i>SimpleOps > Estáticas > Configuración.cs</i> y cambia el valor los siguientes valores:

        <ul>
            <li>
                <b>RutaDesarrollo:</b> Cámbialo por <i>[RutaSimpleOps]\Código\SimpleOps</i>
            </li>
            <li>
                <b>RutaAplicación:</b> Cámbialo por <i>[RutaSimpleOps]</i>
            </li>
            <li>
                <b>ModoIntegraciónTerceros:</b> Si quieres habilitar la facturación electrónica en un programa tercero (otro ERP, Excel u otro) mediante
                <b>SimpleOps</b>, establécelo en <i>true</i>. Si quieres usar <b>SimpleOps</b>
                como tu ERP y facturador electrónico establécelo en <i>false</i>. <b>Nota:</b> A diciembre de 2021, <b>SimpleOps</b> aún no tiene interfaz
                gráfica y no puede ser usado como ERP, entonces la única opción para facturar electrónicamente es usando un programa tercero.
            </li>
        </ul>

    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/ArchivoConfiguración.png" />

    <p>
        Estos cambios deberás hacerlos la primera vez que abras el código y
        cada vez que te salga el error <i>No se pueden incorporar los cambios...</i> al intentar actualizar el código.
    </p>

    <p>
        Ejecuta <b>SimpleOps</b> (F5), espera unos segundos y te aparecerá un mensaje que dice <i>Base de Datos SQLite Creada</i>. Este mensaje significa
        que realizaste correctamente los pasos anteriores y que se creó la base de datos y todos los archivos necesarios para ejecutar <b>SimpleOps</b>.
        Vuelve al código y suspende la ejecución (Shift + F5).
    </p>

    <h2 id="paso4">4. Configuración de SimpleOps en tu Computador</h2>
    <p>
        Con este procedimiento le informarás a <b>SimpleOps</b> donde puede encontrar los archivos del certificado y harás otras configuraciones
        relacionadas con tu computador.
    </p>
    <p>
        Abre el archivo <i>[RutaSimpleOps]\Opciones\Equipo.json</i> (<i>clic derecho > Abrir con.. > Microsoft Visual Studio</i>)
        y para editarlo más fácil haz <i>clic derecho en el texto > Desminimizar</i> e ingresa los siguientes valores.
    </p>

    <p>
        Para los valores <b>[Texto]</b> usa dobles comillas ("") y para los <b>[Número]</b> ninguna comilla y punto como separador de decimales.
        Los textos debes preprocesarlos con <a href="https://www.freeformatter.com/json-escape.html">esta utilidad</a>.
        En esa utilidad ingresa el texto en el cuadro, haz clic en <i>ESCAPE</i>,
        copia el texto del cuadro <i>Escaped string</i> y pégalo en el archivo <i>Equipo.json</i>. 
        Por ejemplo, el texto <i>D:\Programas\SimpleOps\Firma Electrónica</i> se convierte en <i>D:\\Programas\\SimpleOps\\Firma Electr\u00F3nica</i>, 
        que es el texto que se debe usar.
    </p>

    <ul>

        <li>
            <b>RutaCertificado [Texto]:</b>
            Ruta del archivo PFX con el certificado de firma digital. <i>[RutaSimpleOps]\Firma Electrónica\Certificado.pfx</i>.
        </li>

        <li>
            <b>RutaClaveCertificado [Texto]:</b>
            Ruta del archivo TXT con una sola línea que contiene la clave del certificado de firma digital.
            <i>[RutaSimpleOps]\Firma Electrónica\Clave.txt</i>.
        </li>

        <li>
            <b>RutaIntegraci\u00F3n [Texto]:</b>
            Carpeta usada para almacenar los archivos de comunicación entre <b>SimpleOps</b> y un programa tercero.
            <i>[RutaSimpleOps]\Programa Tercero\Integración SimpleOps</i>.
        </li>

        <li>
            <b>Relaci\u00F3nFuentesPdfPantalla [Número]:</b>
            Valor necesario para calcular correctamente si una factura necesita una o más hojas. Si tu monitor es de 24 pulgadas o menos, usa 0.7422.
            Si tu monitor es mayor a 24 pulgadas, calcula este factor con 0.7422 / (Factor de escala de Windows / 100). El factor de escala lo encuentras
            en <i>Configuración > Sistema > Pantalla > Configuración avanzada de escala > Personalizar la escala</i>.
        </li>
    </ul>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/ConfiguraciónEquipoJson.png" />

    <p>Presiona <i>Ctrl + S</i> para guardar los cambios realizados.</p>

    <h2 id="paso5">5. Configuración de los Datos de tu Empresa en SimpleOps</h2>

    <p>
        <b>SimpleOps</b> necesitará toda la información de tu empresa para poder generar facturas válidas ante la DIAN. Para hacerlo necesitarás agregar
        varios datos de tu empresa al archivo <i>Empresa.json</i>. Abre el archivo <i>[RutaSimpleOps]\Opciones\Empresa.json</i> y edítalo
        siguiendo las mismas recomendaciones de la edición de <i>Equipo.json</i>. Para los valores <b>[Fecha]</b> usa el 
        formato "YYYY-MM-DDT00:00:00Z" (con dobles comillas) y para los <b>[Booleano]</b> usa true para verdadero o false para falso (sin comillas). 
        Si un texto tiene tildes o eñes, debes preprocesarlo con <a href="https://www.freeformatter.com/json-escape.html">esta utilidad</a>, si no las 
        tiene, lo puedes ingresar sin preprocesarlo.
    </p>

    <ul>
        <li>
            <b>MunicipioFacturaci\u00F3nID [Número]:</b>
            ID del municipio de la dirección de facturación. Encuentra los IDs de los municipios <a href="IDs Municipios.html">aquí</a>.
        </li>

        <li>
            <b>MunicipioUbicaci\u00F3nID [Número]:</b>
            Se usa si es necesario especificar un municipio diferente al de facturación para la ubicación de la empresa.
            Si se deja en <i>null</i>, se usa MunicipioFacturaciónID.
        </li>

        <li>
            <b>Raz\u00F3nSocial [Texto]:</b>
            Razón social como está registrada en el RUT.
        </li>

        <li>
            <b>Tel\u00E9fonoPrincipal [Texto]:</b>
            Línea telefónica principal. Puede ser celular o fijo.
        </li>

        <li>
            <b>EmailVentas [Texto]:</b>
            Email principal de ventas. Se escribirá en la representación gráfica de la factura electrónica.
        </li>

        <li>
            <b>SitioWeb [Texto]:</b>
            Sitio web. Si no tiene, puedes dejarlo en <i>null</i>.
        </li>

        <li>
            <b>Direcci\u00F3nFacturaci\u00F3n [Texto]:</b>
            Dirección de facturación registrada en el RUT.
        </li>

        <li>
            <b>Direcci\u00F3nUbicaci\u00F3n  [Texto]:</b>
            Se usa si es necesario especificar una dirección diferente a la de facturación para la ubicación de la empresa.
            Si se deja en <i>null</i>, se usa la dirección de facturación.
        </li>

        <li>
            <b>Nit [Texto]:</b>
            Nit sin dígito de verificación.
        </li>

        <li>
            <b>NombreComercial [Texto]:</b>
            Se usa para informarlo a la DIAN al hacer la factura electrónica y para usarlo en representación gráfica de la factura electrónica.
            Si se deja en <i>null</i>, se omite en la factura electrónica y en la representación gráfica se usa la razón social.
        </li>

        <li>
            <b>TipoContribuyente [Texto]:</b>
            Los tipos de contribuyente que le aplican separados por coma. Las opciones disponibles son:
            Ordinario (le aplica a las empresas que no se ha acogido a uno de los otros régimenes como simple o gran contribuyente), GranContribuyente
            Autorretenedor, RetenedorIVA, RégimenSimple, ResponsableIVA y NoResponsableIVA.
        </li>

        <li>
            <b>N\u00FAmeroAutorizaci\u00F3nFacturaci\u00F3n [Número]:</b>
            Número del código de la resolución otorgada para la numeración de facturación.
            El número que copiaste desde el portal de la DIAN con nombre <i>NúmeroAutorizaciónFacturación</i>.
        </li>

        <li>
            <b>InicioAutorizaci\u00F3nFacturaci\u00F3n [Fecha]:</b>
            Fecha inicial de la autorización de la numeración de facturación.
            La fecha que copiaste desde el portal de la DIAN con nombre <i>InicioAutorizaciónFacturación</i>. Recuerda usar el formato
            "YYYY-MM-DDT00:00:00Z" para ingresar las fechas, por ejemplo "2019-01-19T00:00:00Z".
        </li>

        <li>
            <b>FinAutorizaci\u00F3nFacturaci\u00F3n [Fecha]:</b>
            Fecha final de la autorización de la numeración de facturación.
            La fecha que copiaste desde el portal de la DIAN con nombre <i>FinAutorizaciónFacturación</i>.
        </li>

        <li>
            <b>PrefijoFacturas [Texto]:</b>
            Prefijo de la autorización de numeración de facturación dado por el SIE de numeración.
            Como primero vas a realizar las pruebas de facturación, ingresa el prefijo de pruebas: "SETP".
        </li>

        <li>
            <b>PrimerN\u00FAmeroFacturaAutorizada [Número]:</b>
            Valor inicial del rango de numeración otorgado por la DIAN.
            El número que copiaste desde el portal de la DIAN con nombre <i>PrimerNúmeroFacturaAutorizada</i>. Ingrésalo sin comas ni puntos.
        </li>

        <li>
            <b>\u00DAltimoN\u00FAmeroFacturaAutorizada [Número]:</b>
            Valor final del rango de numeración otorgado por la DIAN.
            El número que copiaste desde el portal de la DIAN con nombre <i>ÚltimoNúmeroFacturaAutorizada</i>.
        </li>

        <li>
            <b>IdentificadorPruebas [Texto]:</b>
            Texto provisto por la DIAN para realizar las pruebas de habilitación de facturación electrónica.
            El texto que copiaste desde el portal de la DIAN con nombre <i>IdentificadorPruebas</i>.
        </li>

        <li>
            <b>IdentificadorAplicaci\u00F3n [Texto]:</b>
            Identificador de la aplicación habilitado para la emisión de facturas electrónicas.
            El texto que copiaste desde el portal de la DIAN con nombre <i>IdentificadorAplicación</i>.
        </li>

        <li>
            <b>PinAplicaci\u00F3n [Texto]:</b>
            Pin elegido al habilitar la facturación electrónica en la DIAN.
            El texto que copiaste desde el portal de la DIAN con nombre <i>PinAplicación</i>.
        </li>

        <li>
            <b>ClaveT\u00E9cnicaAplicaci\u00F3n [Texto]:</b>
            Clave dada por la DIAN asociada a la aplicación.
            El texto que copiaste desde el portal de la DIAN con nombre <i>ClaveTécnicaAplicación</i>.
        </li>

        <li>
            <b>NombreContactoFacturaci\u00F3n [Texto]:</b>
            Nombre de la persona encargada de la facturación. Se usa para escribirlo en la factura electrónica (XML).
            No es obligatorio, pero los clientes podrían hacer uso de él.
        </li>

        <li>
            <b>Tel\u00E9fonoContactoFacturaci\u00F3n [Texto]:</b>
            Teléfono de la persona encargada de la facturación. Se usa para escribirlo en la factura electrónica (XML).
            No es obligatorio, pero los clientes podrían hacer uso de él.
        </li>

        <li>
            <b>EmailContactoFacturaci\u00F3n [Texto]:</b>
            Email de la persona encargada de la facturación. Se usa para escribirlo en la factura electrónica (XML).
            No es obligatorio, pero los clientes podrían hacer uso de él.
        </li>

        <li>
            <b>MostrarUnidad [Booleano]:</b>
            Ingresa <i>true</i> (sin comillas) si tu empresa vende productos con diferentes unidades de medida (par, unidad, etc) o
            si tu empresa no maneja diferentes unidades de medida, pero deseas que la unidad de medida <i>unidad</i> se muestre en la
            representación gráfica de la factura electrónica. Si no quieres que se muestre la unidad de medida ingresa <i>false</i>.
        </li>

    </ul>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/AdiciónDatosEmpresa.png" />

    <p>Presiona <i>Ctrl + S</i> para guardar los cambios realizados.</p>


    <h2 id="paso6">6. Pruebas Internas de Facturación</h2>
    <p>
        <b>SimpleOps</b> ya está listo para iniciar las pruebas de facturación electrónica. Primero se realizarán unas pruebas internas
        y después se realizarán las pruebas oficiales ante la DIAN, que una vez cumplidas activan el estatus de tu empresa como facturador electrónico
        usando <b>SimpleOps</b>.
    </p>

    <p>
        Ejecuta <b>SimpleOps</b>, haz clic en el botón <i>Hacer Pruebas Internas</i>, espera unos segundos y te aparecerá un mensaje sobre
        el envío de documentos electrónicos a la DIAN, léelo y haz clic en <i>Aceptar</i>. Si realizaste correctamente todos los pasos anteriores,
        te aparecerá un mensaje de éxito que significa que <b>SimpleOps</b> se comunicó con el servidor de la DIAN en nombre de tu empresa y pudo
        enviar exitósamente la primera factura electrónica de prueba interna. Haz clic en <i>Aceptar</i> y se ejecutarán varias pruebas de otras
        facturas, notas débito y notas crédito. Puedes volver al código y suspender la ejecución cuando desees.
    </p>

    <p>
        Abre la carpeta <i>[RutaSimpleOps]\Documentos Electrónicos\[Año]\[Mes]-[Día]</i> donde encontrarás las representaciones
        gráficas (archivos PDF) de los documentos de prueba que acabas de enviar a la DIAN y las facturas electrónicas (archivos XML).
        Puedes personalizar los colores y las imagenes en la factura usando <a href="Personalización Plantillas de Documentos.html">esta guía</a>.
    </p>

    <p>
        Si abres el portal de habilitación de la DIAN y haces clic en <i>Documentos > Enviados</i>, podrás verificar los documentos electrónicos
        de prueba que has generado con <b>SimpleOps</b>.
    </p>

    <p>
        Un error común que te puede salir es <i>Rechazo 90: Documento con CUFE '...' procesado anteriormente</i>. Esto se puede deber a que estás
        intentando hacer una factura electrónica con un número que ya usaste antes. Para solucionarlo suspende la ejecución,
        ingresa al portal de habilitación de la DIAN, haz clic en <i>Documentos > Enviados</i>, toma nota del último de pruebas SETP990000###
        (sin tener en cuenta el 99 inicial), súmale 1 a ese número, escríbe el valor resultante en <i>[RutaSimpleOps]\Opciones\Empresa.json</i>
        > <i>Pr\u00F3ximoN\u00FAmeroDocumentoElectr\u00F3nicoPruebas</i>, guarda el archivo e intenta nuevamente.
    </p>

    <h2 id="paso7">7. Pruebas de Habilitación en la DIAN</h2>
    <p>
        Este procedimiento habilitará a tu empresa cómo facturador electrónico usando <b>SimpleOps</b> en la DIAN y no podrás seguir facturando 
        de la forma tradicional física. Si actualmente facturas con la solución gratuita de la DIAN o con un operador tecnológico, aún podrás seguir 
        facturando de esa forma.
    </p>

    <p>
        Ejecuta <b>SimpleOps</b> y presiona el botón <i>Hacer Pruebas Habilitación</i>. Se generarán
        las mismas facturas que en las pruebas internas, pero esta vez le informará a la DIAN que las sume a las requeridas para
        habilitar a tu empresa como facturador electrónico. Al recibir los primeros mensajes de éxito (de la primera factura y de la primera nota
        crédito), no hagas clic inmediatamente en <i>Aceptar</i>, espera un par de minutos y después haz clic en <i>Aceptar</i>.
        Esto es necesario porque en ocasiones el servidor de la DIAN no acepta las notas crédito y débito si se hacen muy seguidas de los
        documentos anteriores. Haz clic en <i>Aceptar</i> en los siguientes mensajes de éxito (nota débito y siguientes facturas) hasta que termine
        con todos.
    </p>

    <p>
        Ingresa al portal de habilitación de la DIAN y te aparecerá un mensaje que te pide la fecha de inicio de producción. Esta es la fecha
        a partir de la cual empezarás a facturar electrónicamente con <b>SimpleOps</b>. Selecciona la fecha y haz clic en <i>Aceptar</i>.
        Haz clic en <i>Aceptar</i> en el siguiente mensaje y habrás terminado las pruebas de habilitación.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/FechaInicioProducción.png" />

    <h2 id="paso8">8. Solicitud de la Resolución de Facturación Electrónica a la DIAN</h2>
    <p>
        Para poder iniciar la facturación electrónica con <b>SimpleOps</b>, se requiere informarle a la DIAN el prefijo y el rango de
        numeración que usarás en tus facturas electrónicas. Este procedimiento normalmente lo realiza el contador o representante legal
        de tu empresa ya que implica ingresar al portal de la DIAN con su contraseña. Puedes ver <a href="https://vimeo.com/369961366">este video</a>
        para conocer cómo se realiza. Una vez realizado, solicítale el archivo de la resolución a la persona encargada,
        lo necesitarás para el siguiente paso.
    </p>

    <h2 id="paso9">9. Configuración de Modo Producción</h2>
    <p>
        Haz dos copias del archivo <i>[RutaSimpleOps]\Opciones\Empresa.json</i> y renómbralos a <i>Empresa - Producción.json</i> y
        <i>Empresa - Pruebas.json</i> respectivamente. Abre el archivo de la resolución de autorización numeración de facturación y el archivo
        <i>Empresa - Producción.json</i> y copia los siguientes valores de la resolución al archivo JSON:
        <ul>
            <li>
                <b>N\u00FAmeroAutorizaci\u00F3nFacturaci\u00F3n [Texto]:</b> Casilla <i>4. Número de formulario</i> en la resolución.
            </li>
            <li>
                <b>PrefijoFacturas [Texto]:</b> Casilla <i>31. Prefijo</i> en la resolución.
            </li>
            <li>
                <b>PrimerN\u00FAmeroFacturaAutorizada [Número]:</b> Casilla <i>32. Desde el número</i> en la resolución.
            </li>
            <li>
                <b>\u00DAltimoN\u00FAmeroFacturaAutorizada [Número]:</b> Casilla <i>33. Hasta el número</i> en la resolución.
            </li>
            <li>
                <b>InicioAutorizaci\u00F3nFacturaci\u00F3n [Fecha]:</b> Casilla <i>997. Fecha formalización</i> en la resolución. Usa únicamente la fecha,
                no es necesario agregar horas ni minutos ni segundos.
            </li>
            <li>
                <b>FinAutorizaci\u00F3nFacturaci\u00F3n [Fecha]:</b> Fecha resultante de sumar a la casilla <i>997. Fecha formalización</i> la cantidad
                de meses en la casilla <i>38. Vigencia</i>.
            </li>
            <li>
                <b>AmbienteFacturaci\u00F3nElectr\u00F3nica [Texto]:</b> Cambia <i>Pruebas</i> por <i>Producci\u00F3n</i>.
            </li>
        </ul>

    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/AutorizaciónNumeraciónFacturaciónElectrónica.png" />
    <p>Presiona <i>Ctrl + S</i> para guardar los cambios realizados.</p>

    <p>
        Ingresa al portal de facturador: en <a href="https://www.dian.gov.co">www.dian.gov.co</a> haz clic en
        <i>Temas de interés > Factura Electrónica > Facturando Electrónicamente</i> e ingresa de la misma manera que al portal de habilitación.
        Haz clic en <i>Partipantes > Asociar prefijos</i>. En <i>Proveedor - Software</i> selecciona
        la opción <i>[NombreDeTuEmpresa] - SimpleOps[NitDeTuEmpresa]</i>, en <i>Prefijo</i> selecciona la opción que contiene el prefijo, número
        de resolución y rango de numeración recién autorizado y haz clic en <i>Agregar</i>. Verifica que la fecha de expiración sea la misma que
        ingresaste en <i>Empresa - Producción.json</i> > <i>FinAutorizaci\u00F3nFacturaci\u00F3n</i>. Si en la tabla hay un rango de numeración 
        anterior que ya no usarás, elimínalo.
    </p>
    <img src="Imágenes/Instalación y Habilitación Facturación Electrónica/AsociaciónPrefijosPortalDIAN.png" />


    <p>
        Vuelve a la carpeta <i>[RutaSimpleOps]\Opciones</i>, elimina
        el archivo <i>Empresa.json</i>, haz una copia de <i>Empresa - Producción.json</i> y renombra la copia a <i>Empresa.json</i>.
        <b>Advertencia:</b> Con este cambio, <b>SimpleOps</b> funcionará en modo de producción de facturación electrónica y las facturas que se generen
        serán legalmente válidas ante la DIAN.
    </p>

    <p>
        Ejecuta <b>SimpleOps</b> y haz clic en el botón <i>Obtener Clave Tecnica</i>. Te aparecerá un mensaje con la clave técnica del ambiente de
        producción. Puedes copiar el texto del mensaje con <i>Ctrl + C</i> y pegarlo en el bloc de notas para más facilidad. Suspende la ejecución, abre
        <i>Empresa - Producción.json</i> e ingresa el valor de la clave técnica en <i>ClaveT\u00E9cnicaAplicaci\u00F3n</i>. Guarda los cambios realizados,
        cierra el archivo y nuevamente haz el procedimiento del parrafo anterior.
    </p>

    <p>
        Este procedimiento y el <i>8. Solicitud de la Resolución de Facturación Electrónica a la DIAN</i> los deberás repetir cada vez que se te venza
        la autorización de numeración.
    </p>

    <p>
        ¡Con esto has finalizado los procedimientos con la DIAN y <b>SimpleOps</b> está listo para facturar electrónicamente!
    </p>

    <h2 id="paso10">10. Facturación Electrónica</h2>
    <p>
        La facturación electrónica se puede hacer directamente con <b>SimpleOps</b>
        funcionando como tu aplicación ERP o mediante el uso de un programa tercero (otro ERP, Excel u otro). <b>Nota:</b> A diciembre de 2021, 
        <b>SimpleOps</b> aún no tiene interfaz gráfica y no puede ser usado como ERP, entonces la única opción para facturar electrónicamente 
        es usando un programa tercero.
    </p>

    <p>
        Para facturar electrónicamente usando un programa tercero necesitarás que ese programa lleve el registro del concecutivo de facturación
        y que genere un archivo JSON con la información mínima para generar la factura y en <b>SimpleOps</b> debes establecer
        <i>Estáticas > Configuración.cs > ModoIntegraciónTerceros</i> en <i>true</i>. En este modo <b>SimpleOps</b> supervisa una carpeta del
        computador y si encuentra que un nuevo archivo ha sido añadido, lo procesa, le envía la factura
        electrónica a la DIAN, genera la representación gráfica en PDF y genera un archivo respuesta que puede ser leído por el programa tercero,
        que contiene el resultado de la operación y la descripción de errores si se presentan.
    </p>

    <p>
        A continuación puedes ver un texto de ejemplo con la información necesaria que debe contener un archivo JSON para generar una factura electrónica:
    </p>

    <p class="código">
        {<br />
        "OrdenCompraN\u00FAmero": "OC222",<br />
        "Raz\u00F3n": "Otra",<br />
        "VentaPrefijo": null,<br />
        "VentaN\u00FAmero": null,<br />
        "L\u00EDneas": [<br />
        &nbsp;&nbsp;&nbsp;&nbsp;{<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"Cantidad": 10,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"Precio": 70000,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoReferencia": "CMV",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoAtributos": [],<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoTieneBase": false,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoDescripci\u00F3nEspec\u00EDfica": "Camiseta Verde",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoUnidadEspec\u00EDfica": "Unidad",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoPorcentajeIVAPropioEspec\u00EDfico": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoExclu\u00EDdoIVAEspec\u00EDfico": false,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseDescripci\u00F3n": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseUnidad": "Desconocida",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBasePorcentajeIVAPropio": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseExclu\u00EDdoIVA": false,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoArchivoInformaci\u00F3nEspec\u00EDfica": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoArchivoImagenEspec\u00EDfica": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoCaracter\u00EDsticasEspec\u00EDficas": [],<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseArchivoInformaci\u00F3n": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseArchivoImagen": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseCaracter\u00EDsticas": []<br />
        &nbsp;&nbsp;&nbsp;&nbsp;},<br />
        &nbsp;&nbsp;&nbsp;&nbsp;{<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"Cantidad": 2,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"Precio": 55000,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoReferencia": "CMA",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoAtributos": [],<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoTieneBase": false,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoDescripci\u00F3nEspec\u00EDfica": "Camiseta Azul",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoUnidadEspec\u00EDfica": "Unidad",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoPorcentajeIVAPropioEspec\u00EDfico": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoExclu\u00EDdoIVAEspec\u00EDfico": false,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseDescripci\u00F3n": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseUnidad": "Desconocida",<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBasePorcentajeIVAPropio": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseExclu\u00EDdoIVA": false,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoArchivoInformaci\u00F3nEspec\u00EDfica": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoArchivoImagenEspec\u00EDfica": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoCaracter\u00EDsticasEspec\u00EDficas": [],<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseArchivoInformaci\u00F3n": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseArchivoImagen": null,<br />
        &nbsp;&nbsp;&nbsp;&nbsp;"ProductoBaseCaracter\u00EDsticas": []<br />
        &nbsp;&nbsp;&nbsp;&nbsp;}<br />
        ],<br />
        "N\u00FAmero": 1,<br />
        "Prefijo": "F",<br />
        "Observaci\u00F3n": "Observaci\u00F3n sobre la venta.",<br />
        "MostrarInformaci\u00F3nAdicional": false,<br />
        "FechaHora": "2021-01-26T00:00:00.0000000Z",<br />
        "ClienteNombre": "Empresa Ensayo",<br />
        "ClienteTel\u00E9fono": "2202020",<br />
        "ClienteMunicipioNombre": "Bogot\u00E1, D.C.",<br />
        "ClienteMunicipioDepartamento": "Bogot\u00E1",<br />
        "ClienteDirecci\u00F3n": "Calle 20 20 20",<br />
        "ClienteContactoFacturasEmail": "facturas@empresaensayo.com",<br />
        "ClienteD\u00EDasCr\u00E9dito": 30,<br />
        "ClienteMunicipioPorcentajeIVAPropio": null,<br />
        "ClientePorcentajeIVAPropio": null,<br />
        "ClienteTipoEntidad": "Empresa",<br />
        "ClienteIdentificaci\u00F3n": "900900900"<br />
        }<br />
    </p>

    <p>
        La mayoría de los elementos son autoexplicativos, pero algunos requieren explicación adicional:
        <ul>
            <li>
                <b>VentaPrefijo:</b> Prefijo de la factura a la que se le aplicará la nota crédito. Para facturas se deja en null.
            </li>
            <li>
                <b>VentaN\u00FAmero:</b> Número de la factura a la que se le aplicará la nota crédito. Para facturas se deja en null.
            </li>
            <li>
                <b>ProductoUnidadEspec\u00EDfica:</b> Principalmente puede ser Par o Unidad.
            </li>
            <li>
                <b>ProductoPorcentajeIVAPropioEspec\u00EDfico:</b> Se usa si al producto le aplica un IVA diferente de la tarifa predeterminada
                (19% para mayo de 2021). Debes ingresar el valor en decimal, por ejemplo 0.05 para 5%.
                Si lo dejas en null, se aplicará la tarifa predeterminada.
            </li>
            <li>
                <b>ProductoExclu\u00EDdoIVAEspec\u00EDfico:</b> Si se establece en <i>true</i> es excluído de IVA y tiene un tratamiento tributario diferente porque no suma
                a la base tributable.
            </li>
            <li>
                <b>N\u00FAmero:</b> Número consecutivo de la factura o nota crédito. Este número lo debe controlar y aumentar el programa tercero.
            </li>
            <li>
                <b>ClienteMunicipioNombre y ClienteMunicipioDepartamento:</b> Deben coincidir con los de
                <a href="IDs Municipios.html">esta tabla</a> y deben ser procesados para omitir los carácteres inválidos para el JSON,
                como lo hace <a href="https://www.freeformatter.com/json-escape.html">esta utilidad</a>.
            </li>
            <li>
                <b>ClienteIdentificaci\u00F3n:</b> Nit del cliente sin número de verificación.
            </li>
        </ul>
    </p>

    <p>
        Para probar el modo de integración con terceros cambia al modo de pruebas para evitar generar facturas legales:
        en la carpeta <i>[RutaSimpleOps]\Opciones</i> elimina el archivo <i>Empresa.json</i>, haz una copia de
        <i>Empresa - Pruebas.json</i> y renombra la copia a <i>Empresa.json</i>.
    </p>

    <p>
        Copia el texto JSON de ejemplo, pégalo en el Bloc de Notas, cambia el valor de <i>N\u00FAmero</i> por el valor en
        <i>Empresa.json > Pr\u00F3ximoN\u00FAmeroDocumentoElectr\u00F3nicoPruebas</i> más el valor de <i>PrimerN\u00FAmeroFacturaAutorizada</i>,
        el <i>Prefijo</i> por <i>SETP</i> y guárdalo con el nombre <i>VT-yyyy-MM-dd HH-mm-ss.json</i>, por ejemplo <i>VT-2021-01-26 23-29-00.json</i>
        si la fecha y hora actual es 26 de enero de 2021 a las 11:29 pm.
        Ejecuta <b>SimpleOps</b> y copia y pega (no lo cortes) el archivo JSON en <i>[RutaSimpleOps]\Programa Tercero\Integración SimpleOps</i>.
        Unos segundos después aparecerá en la misma carpeta un archivo <i>VT-yyyy-MM-dd HH-mm-ss.ok</i> que significa que la factura electrónica fue
        generada exitosamente y si lo abres con el bloc de notas encontrarás las rutas al PDF de la representación gráfica y al XML. Si aparece
        un archivo <i>VT-yyyy-MM-dd HH-mm-ss.error</i>, significa que hubo un error que podrás leer abriendo este archivo con el bloc
        de notas.
    </p>

    <p>
        Una vez finalices tus ensayos, podrás generar tu primera factura electrónica legal con el modo de integración con terceros.
        Suspende la ejecución y cambia al modo de producción:
        en la carpeta <i>[RutaSimpleOps]\Opciones</i> elimina el archivo <i>Empresa.json</i>, haz una copia de
        <i>Empresa - Producción.json</i> y renombra la copia a <i>Empresa.json</i>.
    </p>

    <p>
        Copia el texto JSON de ejemplo, pégalo en el bloc de notas, cambia el valor de <i>N\u00FAmero</i> por el valor en
        <i>Empresa.json > PrimerN\u00FAmeroFacturaAutorizada</i>,
        el <i>Prefijo</i> por <i>Empresa.json > PrefijoFacturas</i> y guárdalo con el nombre <i>VT-yyyy-MM-dd HH-mm-ss.json</i>.
        Cambia el resto de los datos a los valores reales de tu primera factura electrónica legal.
        Ejecuta <b>SimpleOps</b> y copia y pega (no lo cortes) el archivo JSON en <i>[RutaSimpleOps]\Programa Tercero\Integración SimpleOps</i>.
        Unos segundos después aparecerá en la misma carpeta un archivo <i>VT-yyyy-MM-dd HH-mm-ss.ok</i> que significa que la factura electrónica fue
        generada exitosamente o <i>VT-yyyy-MM-dd HH-mm-ss.error</i> si hubo un error.
    </p>

    <p>
        En la carpeta <i>[RutaSimpleOps]\Documentos Electrónicos\[Año]\[Mes]-[Día]</i> puedes encontrar la representación gráfica (PDF) y
        la factura electrónica (XLM) que acabas de generar. Si quieres verificar si la factura efectivamente fue aceptada por la DIAN, puedes
        entrar a su portal de facturador y hacer clic en <i>Documentos > Enviados</i>. Si la factura eléctrónica aparece allí, habrás configurado
        exitósamente <b>SimpleOps</b> para funcione como facturador electrónico de un programa tercero.
    </p>

    <h2 id="paso11">11. Facturación Electrónica usando Excel (Opcional)</h2>

    <p>
        Excel es un programa tercero que puedes usar en compañía de <b>SimpleOps</b> para facturar electrónicamente.
        Su ubicuidad y facilidad de uso lo hacen perfecto para independientes y pequeñas empresas con bajos niveles de facturación.
    </p>

    <p>
        <b>[Pendiente]</b> Si quieres saber cómo se podría facturar electrónicamente usando Excel, escríbeme a vixark@outlook.com y procuraré
        completar esta guía.
    </p>


</body>

</html>